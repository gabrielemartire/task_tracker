<p style="color: green"><%= notice %></p>

<div>
  <%= link_to "Back to projects", projects_path %>
</div>

<h1><%= @project.name %></h1>
<p><%= @project.description %></p>

<h2>Tasks</h2>

<!-- filters -->
<div>
  <%= link_to "All", project_path(@project) %>
  <%= link_to "Todo", project_path(@project, status: 'todo', priority: @params[:priority]) %>
  <%= link_to "In Progress", project_path(@project, status: 'in_progress', priority: @params[:priority]) %>
  <%= link_to "Done", project_path(@project, status: 'done', priority: @params[:priority]) %>
  
  <%= link_to "Priority 1", project_path(@project, priority: 1, status: @params[:status]) %>
  <%= link_to "Priority 2", project_path(@project, priority: 2, status: @params[:status]) %>
  <%= link_to "Priority 3", project_path(@project, priority: 3, status: @params[:status]) %>
  <%= link_to "Priority 4", project_path(@project, priority: 4, status: @params[:status]) %>
  <%= link_to "Priority 5", project_path(@project, priority: 5, status: @params[:status]) %>
</div>

<table>
  <thead>
    <tr>
      <th>Title</th>
      <th>Status</th>  
      <th>Due Date</th>
      <th>Priority</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% @tasks.each do |task| %>
      <tr>
        <td><%= task.title %></td>
        <td><%= task.status %></td>
        <td><%= task.due_date&.strftime("%B %d, %Y") %></td>
        <td><%= task.priority %></td>
        <td>
          <%= link_to "View", task_path(task) %>

          <% unless task.status == 'done' %>
            <%= button_to "#{task.status == 'todo' ? 'Start' : 'Done'}", 
              project_task_path(@project, task), 
              method: :patch,
              params: { task: { status: task.status == 'todo' ? 'in_progress' : 'done' } } 
            %>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<h2>add task</h2>

<%= render "tasks/form", task: @task, project: @project %>
